package myio;

import java.io.*;

public class MyFile {

    /**
     * Ghi danh sách đối tượng vào file nhị phân
     *
     * @param filename tên của file cần ghi dữ liệu
     * @param objects  mảng các đối tượng cần ghi vào file
     * @throws IOException nếu có lỗi khi ghi vào file
     */
    public static void writeObjectsToFile(String filename, Object[] objects) throws IOException {
        try (ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(filename))) {
            for (Object obj : objects) {
                oos.writeObject(obj);
            }
        }
    }

    /**
     * Đọc danh sách đối tượng từ file nhị phân
     *
     * @param filename tên của file cần đọc dữ liệu
     * @return mảng các đối tượng được đọc từ file
     * @throws IOException            nếu có lỗi khi đọc từ file
     * @throws ClassNotFoundException nếu lớp của đối tượng đọc không được tìm thấy
     */
    public static Object[] readObjectsFromFile(String filename) throws IOException, ClassNotFoundException {
        try (ObjectInputStream ois = new ObjectInputStream(new FileInputStream(filename))) {
            // Đọc đối tượng từ file và thêm vào danh sách
            List<Object> objectList = new ArrayList<>();
            Object obj;
            while ((obj = ois.readObject()) != null) {
                objectList.add(obj);
            }

            // Chuyển đổi danh sách đối tượng thành mảng
            return objectList.toArray();
        }
    }


}
